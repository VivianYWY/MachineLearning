{"paragraphs":[{"text":"val bankText = sc.textFile(\"C:/Users/FKJMPY8/Downloads/bank-full.csv\")","user":"anonymous","dateUpdated":"2018-05-15T07:48:57+0000","config":{"colWidth":11,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":90,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bankText: org.apache.spark.rdd.RDD[String] = C:/Users/FKJMPY8/Downloads/bank-full.csv MapPartitionsRDD[306636] at textFile at <console>:27\n"}]},"apps":[],"jobName":"paragraph_1522931876677_-1820559852","id":"20180405-123756_1970941633","dateCreated":"2018-04-05T12:37:56+0000","dateStarted":"2018-04-06T08:17:06+0000","dateFinished":"2018-04-06T08:17:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4247"},{"text":"case class Bank(age:Integer, job: String, marital:String, education:String,balance:Integer)","user":"anonymous","dateUpdated":"2018-05-15T07:48:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Bank\n"}]},"apps":[],"jobName":"paragraph_1522932581914_-1794352599","id":"20180405-124941_835900438","dateCreated":"2018-04-05T12:49:41+0000","dateStarted":"2018-04-06T08:17:11+0000","dateFinished":"2018-04-06T08:17:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4248"},{"title":"","text":"val bank = bankText.map(s=>s.split(\";\")).filter(s=>s(0)!=\"\\\"age\\\"\").map(\n    s=>Bank(s(0).toInt,\n            s(1).replaceAll(\"\\\"\",\"\"),\n            s(2).replaceAll(\"\\\"\",\"\"),\n            s(3).replaceAll(\"\\\"\",\"\"),\n            s(5).replaceAll(\"\\\"\",\"\").toInt\n            )\n)\n\nbank.toDF().createOrReplaceTempView(\"bank\")","user":"anonymous","dateUpdated":"2018-05-15T07:48:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":false,"lineNumbers":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bank: org.apache.spark.rdd.RDD[Bank] = MapPartitionsRDD[307709] at map at <console>:31\n"}]},"apps":[],"jobName":"paragraph_1522932703770_1895724840","id":"20180405-125143_1206459191","dateCreated":"2018-04-05T12:51:43+0000","dateStarted":"2018-04-06T08:21:26+0000","dateFinished":"2018-04-06T08:21:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4249"},{"text":"val data = Array(1,2,3,4,5)","user":"anonymous","dateUpdated":"2018-05-15T07:48:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data: Array[Int] = Array(1, 2, 3, 4, 5)\n"}]},"apps":[],"jobName":"paragraph_1523002601529_638807758","id":"20180406-081641_628416571","dateCreated":"2018-04-06T08:16:41+0000","dateStarted":"2018-05-14T13:21:02+0000","dateFinished":"2018-05-14T13:21:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4250"},{"text":"val distData = sc.parallelize(data)","user":"anonymous","dateUpdated":"2018-05-15T07:48:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"distData: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[21795] at parallelize at <console>:34\n"}]},"apps":[],"jobName":"paragraph_1523007160154_-131596410","id":"20180406-093240_228900740","dateCreated":"2018-04-06T09:32:40+0000","dateStarted":"2018-05-14T13:21:05+0000","dateFinished":"2018-05-14T13:21:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4251"},{"text":"import org.apache.spark.sql.SparkSession","user":"anonymous","dateUpdated":"2018-05-15T07:48:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"paragraph_1523017257421_1375715602's Interpreter null not found"}]},"apps":[],"jobName":"paragraph_1523017257421_1375715602","id":"20180406-122057_1362405045","dateCreated":"2018-04-06T12:20:57+0000","status":"ERROR","errorMessage":"org.apache.zeppelin.interpreter.InterpreterException: paragraph_1523017257421_1375715602's Interpreter null not found\n\tat org.apache.zeppelin.notebook.Note.run(Note.java:621)\n\tat org.apache.zeppelin.socket.NotebookServer.persistAndExecuteSingleParagraph(NotebookServer.java:1647)\n\tat org.apache.zeppelin.socket.NotebookServer.runParagraph(NotebookServer.java:1621)\n\tat org.apache.zeppelin.socket.NotebookServer.onMessage(NotebookServer.java:266)\n\tat org.apache.zeppelin.socket.NotebookSocket.onWebSocketText(NotebookSocket.java:59)\n\tat org.eclipse.jetty.websocket.common.events.JettyListenerEventDriver.onTextMessage(JettyListenerEventDriver.java:128)\n\tat org.eclipse.jetty.websocket.common.message.SimpleTextMessage.messageComplete(SimpleTextMessage.java:69)\n\tat org.eclipse.jetty.websocket.common.events.AbstractEventDriver.appendMessage(AbstractEventDriver.java:65)\n\tat org.eclipse.jetty.websocket.common.events.JettyListenerEventDriver.onTextFrame(JettyListenerEventDriver.java:122)\n\tat org.eclipse.jetty.websocket.common.events.AbstractEventDriver.incomingFrame(AbstractEventDriver.java:161)\n\tat org.eclipse.jetty.websocket.common.WebSocketSession.incomingFrame(WebSocketSession.java:309)\n\tat org.eclipse.jetty.websocket.common.extensions.ExtensionStack.incomingFrame(ExtensionStack.java:214)\n\tat org.eclipse.jetty.websocket.common.Parser.notifyFrame(Parser.java:220)\n\tat org.eclipse.jetty.websocket.common.Parser.parse(Parser.java:258)\n\tat org.eclipse.jetty.websocket.common.io.AbstractWebSocketConnection.readParse(AbstractWebSocketConnection.java:632)\n\tat org.eclipse.jetty.websocket.common.io.AbstractWebSocketConnection.onFillable(AbstractWebSocketConnection.java:480)\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:4252"},{"text":"// Create the case classes for our domain\r\ncase class Department(id: String, name: String)\r\ncase class Employee(firstName: String, lastName: String, email: String, salary: Int)\r\ncase class DepartmentWithEmployees(department: Department, employees: Seq[Employee])\r\n\r\n// Create the Departments\r\nval department1 = new Department(\"123456\", \"Computer Science\")\r\nval department2 = new Department(\"789012\", \"Mechanical Engineering\")\r\nval department3 = new Department(\"345678\", \"Theater and Drama\")\r\nval department4 = new Department(\"901234\", \"Indoor Recreation\")\r\n\r\n// Create the Employees\r\nval employee1 = new Employee(\"michael\", \"armbrust\", \"no-reply@berkeley.edu\", 100000)\r\nval employee2 = new Employee(\"xiangrui\", \"meng\", \"no-reply@stanford.edu\", 120000)\r\nval employee3 = new Employee(\"matei\", null, \"no-reply@waterloo.edu\", 140000)\r\nval employee4 = new Employee(null, \"wendell\", \"no-reply@princeton.edu\", 160000)\r\n\r\n// Create the DepartmentWithEmployees instances from Departments and Employees\r\nval departmentWithEmployees1 = new DepartmentWithEmployees(department1, Seq(employee1, employee2))\r\nval departmentWithEmployees2 = new DepartmentWithEmployees(department2, Seq(employee3, employee4))\r\nval departmentWithEmployees3 = new DepartmentWithEmployees(department3, Seq(employee1, employee4))\r\nval departmentWithEmployees4 = new DepartmentWithEmployees(department4, Seq(employee2, employee3))","user":"anonymous","dateUpdated":"2018-05-15T07:48:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Department\ndefined class Employee\ndefined class DepartmentWithEmployees\ndepartment1: Department = Department(123456,Computer Science)\ndepartment2: Department = Department(789012,Mechanical Engineering)\ndepartment3: Department = Department(345678,Theater and Drama)\ndepartment4: Department = Department(901234,Indoor Recreation)\nemployee1: Employee = Employee(michael,armbrust,no-reply@berkeley.edu,100000)\nemployee2: Employee = Employee(xiangrui,meng,no-reply@stanford.edu,120000)\nemployee3: Employee = Employee(matei,null,no-reply@waterloo.edu,140000)\nemployee4: Employee = Employee(null,wendell,no-reply@princeton.edu,160000)\ndepartmentWithEmployees1: DepartmentWithEmployees = DepartmentWithEmployees(Department(123456,Computer Science),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(xiangrui,meng,no-reply@stanford.edu,120000)))\ndepartmentWithEmployees2: DepartmentWithEmployees = DepartmentWithEmployees(Department(789012,Mechanical Engineering),List(Employee(matei,null,no-reply@waterloo.edu,140000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees3: DepartmentWithEmployees = DepartmentWithEmployees(Department(345678,Theater and Drama),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(null,wendell,no-reply@princeton.edu,160000)))\ndepartmentWithEmployees4: DepartmentWithEmployees = DepartmentWithEmployees(Department(901234,Indoor Recreation),List(Employee(xiangrui,meng,no-reply@stanford.edu,120000), Employee(matei,null,no-reply@waterloo.edu,140000)))\n"}]},"apps":[],"jobName":"paragraph_1523022436572_-1443837891","id":"20180406-134716_734189364","dateCreated":"2018-04-06T13:47:16+0000","dateStarted":"2018-04-09T11:21:51+0000","dateFinished":"2018-04-09T11:21:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4253"},{"text":"val departmentsWithEmployeesSeq1 = Seq(departmentWithEmployees1, departmentWithEmployees2)\r\nval df1 = departmentsWithEmployeesSeq1.toDF()\r\ndisplay(df1)","user":"anonymous","dateUpdated":"2018-05-15T07:48:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"departmentsWithEmployeesSeq1: Seq[DepartmentWithEmployees] = List(DepartmentWithEmployees(Department(123456,Computer Science),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(xiangrui,meng,no-reply@stanford.edu,120000))), DepartmentWithEmployees(Department(789012,Mechanical Engineering),List(Employee(matei,null,no-reply@waterloo.edu,140000), Employee(null,wendell,no-reply@princeton.edu,160000))))\ndf1: org.apache.spark.sql.DataFrame = [department: struct<id: string, name: string>, employees: array<struct<firstName:string,lastName:string,email:string,salary:int>>]\n<console>:52: error: not found: value display\n       display(df1)\n       ^\n"}]},"apps":[],"jobName":"paragraph_1523272911526_310547311","id":"20180409-112151_1757334312","dateCreated":"2018-04-09T11:21:51+0000","dateStarted":"2018-04-09T11:22:15+0000","dateFinished":"2018-04-09T11:22:18+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:4254"},{"text":"df1","user":"anonymous","dateUpdated":"2018-05-15T07:48:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res8: org.apache.spark.sql.DataFrame = [department: struct<id: string, name: string>, employees: array<struct<firstName:string,lastName:string,email:string,salary:int>>]\n"}]},"apps":[],"jobName":"paragraph_1523272935460_-408132986","id":"20180409-112215_930275054","dateCreated":"2018-04-09T11:22:15+0000","dateStarted":"2018-04-09T11:23:52+0000","dateFinished":"2018-04-09T11:23:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4255"},{"text":"df1.show()","user":"anonymous","dateUpdated":"2018-05-15T07:48:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|          department|           employees|\n+--------------------+--------------------+\n|[123456,Computer ...|[[michael,armbrus...|\n|[789012,Mechanica...|[[matei,null,no-r...|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1523273032070_-1312723623","id":"20180409-112352_579510509","dateCreated":"2018-04-09T11:23:52+0000","dateStarted":"2018-04-09T11:24:32+0000","dateFinished":"2018-04-09T11:24:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4256"},{"text":"val departmentsWithEmployeesSeq2 = Seq(departmentWithEmployees3, departmentWithEmployees4)\r\nval df2 = departmentsWithEmployeesSeq2.toDF()\r\ndf2.show()","user":"anonymous","dateUpdated":"2018-05-15T07:49:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"departmentsWithEmployeesSeq2: Seq[DepartmentWithEmployees] = List(DepartmentWithEmployees(Department(345678,Theater and Drama),List(Employee(michael,armbrust,no-reply@berkeley.edu,100000), Employee(null,wendell,no-reply@princeton.edu,160000))), DepartmentWithEmployees(Department(901234,Indoor Recreation),List(Employee(xiangrui,meng,no-reply@stanford.edu,120000), Employee(matei,null,no-reply@waterloo.edu,140000))))\ndf2: org.apache.spark.sql.DataFrame = [department: struct<id: string, name: string>, employees: array<struct<firstName:string,lastName:string,email:string,salary:int>>]\n+--------------------+--------------------+\n|          department|           employees|\n+--------------------+--------------------+\n|[345678,Theater a...|[[michael,armbrus...|\n|[901234,Indoor Re...|[[xiangrui,meng,n...|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1523273072740_-1187418075","id":"20180409-112432_705458109","dateCreated":"2018-04-09T11:24:32+0000","dateStarted":"2018-04-09T11:25:55+0000","dateFinished":"2018-04-09T11:25:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4257"},{"text":"val unionDF = df1.unionAll(df2)\nunionDF.show()","user":"anonymous","dateUpdated":"2018-05-15T07:49:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nunionDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [department: struct<id: string, name: string>, employees: array<struct<firstName:string,lastName:string,email:string,salary:int>>]\n+--------------------+--------------------+\n|          department|           employees|\n+--------------------+--------------------+\n|[123456,Computer ...|[[michael,armbrus...|\n|[789012,Mechanica...|[[matei,null,no-r...|\n|[345678,Theater a...|[[michael,armbrus...|\n|[901234,Indoor Re...|[[xiangrui,meng,n...|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1523273155020_700868230","id":"20180409-112555_90383042","dateCreated":"2018-04-09T11:25:55+0000","dateStarted":"2018-04-09T11:26:35+0000","dateFinished":"2018-04-09T11:26:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4258"},{"text":"\r\nval llist = Seq((\"bob\", \"2015-01-13\", 4), (\"alice\", \"2015-04-23\",10))\r\nval left = llist.toDF(\"name\",\"date\",\"duration\")\r\nval right = Seq((\"alice\", 100),(\"bob\", 23)).toDF(\"name\",\"upload\")\r\n\r\nval df = left.join(right, left.col(\"name\") === right.col(\"name\"))\r\n\r\ndf.show()","user":"anonymous","dateUpdated":"2018-05-15T07:49:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"llist: Seq[(String, String, Int)] = List((bob,2015-01-13,4), (alice,2015-04-23,10))\nleft: org.apache.spark.sql.DataFrame = [name: string, date: string ... 1 more field]\nright: org.apache.spark.sql.DataFrame = [name: string, upload: int]\ndf: org.apache.spark.sql.DataFrame = [name: string, date: string ... 3 more fields]\n+-----+----------+--------+-----+------+\n| name|      date|duration| name|upload|\n+-----+----------+--------+-----+------+\n|  bob|2015-01-13|       4|  bob|    23|\n|alice|2015-04-23|      10|alice|   100|\n+-----+----------+--------+-----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1523282059129_-1709697550","id":"20180409-135419_735104722","dateCreated":"2018-04-09T13:54:19+0000","dateStarted":"2018-04-09T13:55:06+0000","dateFinished":"2018-04-09T13:55:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4259"},{"text":"val df = left.join(right,Seq(\"name\"))\ndf.show(9)","user":"anonymous","dateUpdated":"2018-05-15T07:49:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [name: string, date: string ... 2 more fields]\n+-----+----------+--------+------+\n| name|      date|duration|upload|\n+-----+----------+--------+------+\n|  bob|2015-01-13|       4|    23|\n|alice|2015-04-23|      10|   100|\n+-----+----------+--------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1523282106433_-186820888","id":"20180409-135506_203762403","dateCreated":"2018-04-09T13:55:06+0000","dateStarted":"2018-04-09T13:56:58+0000","dateFinished":"2018-04-09T13:56:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4260"},{"user":"anonymous","dateUpdated":"2018-05-15T07:49:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525779704004_-1754244269","id":"20180508-114144_866638578","dateCreated":"2018-05-08T11:41:44+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4261"}],"name":"EE_YU/example_basic_operation","id":"2D9QYS62Q","angularObjects":{"2CDBRM16S:shared_process":[],"2CGD9PJEV:shared_process":[],"2CEXJP4VC:shared_process":[],"2CEWFDUFC:shared_process":[],"2CCUD92DR:shared_process":[],"2CE5CMKN8:shared_process":[],"2CCT6VFHB:shared_process":[],"2CGDHC2BR:shared_process":[],"2CD5H5KA3:shared_process":[],"2CCFV6EWC:shared_process":[],"2CG8AUTUC:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}